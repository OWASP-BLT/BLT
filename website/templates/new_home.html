{% extends "base_new.html" %}
{% load static %}
{% block hero %}

    <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'js/infinite.min.js' %}"></script>
    <style>
        .infinite-container {
            grid-template-columns: repeat(auto-fill, minmax(225px, 1fr));
        }
    </style>
        <div class="font-['Barlow'] text-[#2B2B2B] text-5xl tracking-wide font-semibold mb-0 mt-10 ms-[4.3%]">Find bugs, earn points, prize and cash!</div>
        <div class="infinite-container mx-[4%] my-[2.5rem] grid grid-rows-2 gap-[25px]">
    
            {% include '_report_widget.html' %}
    
            {% include '_leaderboard_widget.html' %}
                {% for bug in bugs %}
                    {% include '_bug.html' %}
                {% endfor %}
        </div>
    </div>
    {% if page_obj.has_next %}
        <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}">More</a>
    {% endif %}

    <div class="loading" style="display: none;">
        Loading...
    </div>

    <script>
        var infinite = new Waypoint.Infinite({
        element: $('.infinite-container')[0],
        offset :  'bottom-in-view',
        onBeforePageLoad: function () {
            $('.loading').show();
        },
        onAfterPageLoad: function ($items) {
            $('.loading').hide();
        }
        });
    </script>
    
    <script>
        function like_unlike_handler(e,issue_pk){
            e.preventDefault();
            var issue_pk = issue_pk;
            $.ajax({
                type: 'GET',
                url: '/like_issue2/' + issue_pk + '/',
                data: {},
                success: function (data) {
                    // Toggle the color of the SVG
                    var svg = $('#likeSvg' + issue_pk);
                    var currentColor = svg.find('path').attr('fill');
    
                    if (currentColor === '#a11010') {
                        // Change to default color
                        svg.find('path').attr('fill', ''); // Set to default color
                    } else {
                        // Change to full red
                        svg.find('path').attr('fill', '#a11010');
                    }
                },
            });
        }
        function flag_unflag_handler(e,issue_pk){
            e.preventDefault();
            var issue_pk = issue_pk;
            $.ajax({
                type: 'GET',
                url: '/flag_issue2/' + issue_pk + '/',
                data: {},
                success: function (data) {
                    // Toggle the color of the SVG
                    var svg = $('#flagSvg' + issue_pk);
                    var currentColor = svg.find('path').attr('fill');
    
                    if (currentColor === '#a11010') {
                        // Change to default color
                        svg.find('path').attr('fill', ''); // Set to default color
                    } else {
                        // Change to full red
                        svg.find('path').attr('fill', '#a11010');
                    }
                },
            });
        }
    </script>
    
    <script>
    var infinite = new Waypoint.Infinite({
        element: $('.infinite-container')[0],
        handler: function(direction) {

    },
    offset: 'bottom-in-view',

    onBeforePageLoad: function () {
    $('.spinner-border').show();
    },
    onAfterPageLoad: function () {
    $('.spinner-border').hide();
    }

    });

    </script>
{% endblock %}
