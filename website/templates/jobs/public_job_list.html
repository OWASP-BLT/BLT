{% extends "base.html" %}
{% load static %}
{% block title %}Job Board - Find Your Next Opportunity{% endblock %}
{% block content %}
    {% include "includes/sidenav.html" %}
    <div class="min-h-screen bg-gray-50 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-900 mb-4">Find Your Next Opportunity</h1>
                <p class="text-xl text-gray-600">
                    Explore exciting job opportunities from leading organizations in cybersecurity and technology
                </p>
            </div>
            <!-- Search Bar -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <form method="get" class="flex gap-4">
                    <input type="text"
                           name="q"
                           value="{{ search_query }}"
                           placeholder="Search by job title, skills, or company..."
                           class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#e74c3c] focus:border-transparent">
                    <select name="type"
                            class="px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#e74c3c] focus:border-transparent">
                        <option value="">All Types</option>
                        <option value="full-time"
                                {% if job_type_filter == 'full-time' %}selected{% endif %}>Full Time</option>
                        <option value="part-time"
                                {% if job_type_filter == 'part-time' %}selected{% endif %}>Part Time</option>
                        <option value="contract"
                                {% if job_type_filter == 'contract' %}selected{% endif %}>Contract</option>
                        <option value="internship"
                                {% if job_type_filter == 'internship' %}selected{% endif %}>Internship</option>
                        <option value="freelance"
                                {% if job_type_filter == 'freelance' %}selected{% endif %}>Freelance</option>
                    </select>
                    <button type="submit"
                            class="px-6 py-3 bg-[#e74c3c] text-white rounded-lg font-semibold hover:bg-red-700 transition-colors">
                        Search
                    </button>
                </form>
            </div>
            {% if jobs %}
                <!-- Results Count -->
                <div class="mb-6">
                    <p class="text-sm text-gray-600">
                        <span class="font-semibold text-gray-900">{{ jobs|length }}</span> job
                        {% if jobs|length != 1 %}s{% endif %}
                        found
                    </p>
                </div>
                <!-- Job Listings -->
                <div class="space-y-4">
                    {% for job in jobs %}
                        <div class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow p-6">
                            <div class="flex justify-between items-start gap-6">
                                <div class="flex-1">
                                    <!-- Company Info -->
                                    <div class="flex items-center gap-3 mb-3">
                                        {% if job.organization.logo %}
                                            <img src="{{ job.organization.logo.url }}"
                                                 alt="{{ job.organization.name }}"
                                                 width="48"
                                                 height="48"
                                                 class="w-12 h-12 rounded-lg object-cover">
                                        {% else %}
                                            <div class="w-12 h-12 bg-[#e74c3c] rounded-lg flex items-center justify-center">
                                                <span class="text-white font-bold text-lg">{{ job.organization.name|first }}</span>
                                            </div>
                                        {% endif %}
                                        <div>
                                            <p class="text-sm text-gray-600">{{ job.organization.name }}</p>
                                        </div>
                                    </div>
                                    <!-- Job Title -->
                                    <h2 class="text-xl font-bold text-gray-900 mb-2">
                                        <a href="{% url 'job_detail' job.id %}" class="hover:text-[#e74c3c]">{{ job.title }}</a>
                                    </h2>
                                    <!-- Job Meta -->
                                    <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-gray-600 mb-3">
                                        {% if job.location %}<span><i class="fas fa-map-marker-alt mr-1"></i> {{ job.location }}</span>{% endif %}
                                        <span><i class="fas fa-briefcase mr-1"></i> {{ job.get_job_type_display }}</span>
                                        {% if job.salary_range %}<span><i class="fas fa-dollar-sign mr-1"></i> {{ job.salary_range }}</span>{% endif %}
                                        <span class="text-gray-500"><i class="fas fa-clock mr-1"></i> Posted {{ job.created_at|timesince }} ago</span>
                                    </div>
                                    <!-- Description -->
                                    <p class="text-gray-700 line-clamp-2">{{ job.description|truncatewords:25 }}</p>
                                </div>
                                <!-- View Button -->
                                <div class="flex-shrink-0">
                                    <a href="{% url 'job_detail' job.id %}"
                                       class="px-6 py-2.5 bg-[#e74c3c] text-white rounded-lg font-semibold hover:bg-red-700 transition-colors inline-flex items-center">
                                        View Details
                                        <i class="fas fa-arrow-right ml-2"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="bg-white rounded-lg shadow-md p-12 text-center">
                    <i class="fas fa-search text-gray-400 text-5xl mb-4"></i>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">No jobs found</h3>
                    <p class="text-gray-600">
                        {% if search_query %}
                            Try adjusting your search terms or filters
                        {% else %}
                            Check back later for new opportunities
                        {% endif %}
                    </p>
                    {% if search_query or job_type_filter %}
                        <a href="{% url 'public_job_list' %}"
                           class="inline-block mt-4 text-[#e74c3c] hover:text-red-700 font-semibold">Clear filters</a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
{% endblock content %}
