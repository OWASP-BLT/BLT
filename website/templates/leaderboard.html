{% extends "base.html" %}
{% load gravatar %}

{% block style %}
<style>
    .list-group-item img {
        width: 50px;
        height: 50px;
    }

    .list-group-item .badge {
        margin-top: 15px;
    }

    .list-group-item a {
        text-decoration: none;
        margin-left: 10px;
    }

    .silver {
        background-color: lightblue;
        color: #333;
    }

    .gold {
        background-color: #D4AF37;
        color: #333;
    }

    .bronze {
        background-color: #C9AE5D;
        color: #333;
    }

    .profileimage {
        border-radius: 50%;
    }

    .titleuser {
        position: absolute;
        margin-top: 12px;
        margin-left: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-6" style="display: flex; justify-content: center; align-items: center;">
        <h1 class="page-header">Global Leaderboard</h1> 
        <select placeholder="MM">
            <option name="" value="" style="display:none;">Month</option>
            <option name="January" value="1">January</option>
            <option name="February" value="2">February</option>
            <option name="March" value="3">March</option>
            <option name="April" value="4">April</option>
                <option name="May" value="5">May</option>
            <option name="June" value="6">June</option>
            <option name="July" value="7">July</option>
            <option name="August" value="8">August</option>
                <option name="September" value="9">September</option>
            <option name="October" value="10">October</option>
            <option name="November" value="11">November</option>
            <option name="December" value="12">December</option>
        </select>              
    </div>
</div>
<div class="row">
    <div class="col-lg-9">
        <div class="list-group">
            {%if not leaderboard%}
                <p style="color: red;">No data for this month</p>
            {%else%}
                {% for leader in leaderboard %}
                <div class="list-group-item">
                    {% if leader.userprofile.avatar %}
                    <img src="{{ leader.userprofile.avatar }}" class="img-responsive img-thumbnail profileimage">
                    {% elif leader.socialaccount_set.all.0.get_avatar_url %}
                    <img src="{{ leader.socialaccount_set.all.0.get_avatar_url }}" class="profileimage">
                    {% else %}
                    <img src="{% gravatar_url leader.email 50 %}" class="profileimage">
                    {% endif %}
                    <a href="/profile/{{ leader.username }}">{{ leader.username }}</a>
                    <span class="pull-right badge">{{ leader.total_score }} Points</span>
                    {% if leader.userprofile.winnings %}
                    <span class="pull-right badge">${{ leader.userprofile.winnings|default:""|floatformat }}</span>
                    {% endif %}

                    <span><kbd
                            class="{{ leader.userprofile.get_title_display }} titleuser">{{ leader.userprofile.get_title_display }}</kbd></span>
                </div>
                {% endfor %}
            {%endif%}
        </div>
    </div>
</div>
{% endblock %}

{% block after_js %}
<script>

    // function getParameterByName(name, url = window.location.href) {
    //     name = name.replace(/[\[\]]/g, '\\$&');
    //     var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
    //         results = regex.exec(url);
    //     if (!results) return null;
    //     if (!results[2]) return '';
    //     return decodeURIComponent(results[2].replace(/\+/g, ' '));
    // }

    $(document).ready(function() {

        // console.log(localStorage.getItem("leaderboard_month"));
        // let selectedOption = $('select option:selected').options[$('select option:selected').selectedIndex].text
        // localStorage.setItem("leaderboard_month",selectedOption);

        $('select').change(function() {
        window.location.href=`?month=${$('select option:selected').val()}`;
        });


    });


</script>
{% endblock %}