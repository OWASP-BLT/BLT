# Generated by Django 5.1.8 on 2025-07-25 10:00

from django.db import migrations, models


def update_challenge_bacon_rewards(apps, schema_editor):
    """Add bacon rewards to existing challenges"""
    Challenge = apps.get_model("website", "Challenge")

    # Define bacon rewards for different challenges
    challenge_rewards = {
        "Report 5 IPs": 10,
        "Report 5 Issues": 15,
        "Sign in for 5 Days": 5,
        "Report 10 IPs": 20,
        "Report 10 Issues": 25,
        "All Members Sign in for 5 Days": 10,
    }

    # Update existing challenges
    for challenge_title, bacon_reward in challenge_rewards.items():
        try:
            challenge = Challenge.objects.get(title=challenge_title)
            challenge.bacon_reward = bacon_reward
            challenge.save()
            print(f"Updated challenge '{challenge_title}' with {bacon_reward} bacon reward")
        except Challenge.DoesNotExist:
            print(f"Challenge '{challenge_title}' not found, skipping...")


def reverse_update_challenge_bacon_rewards(apps, schema_editor):
    """Reverse operation - reset bacon_reward to default value"""
    Challenge = apps.get_model("website", "Challenge")
    Challenge.objects.all().update(bacon_reward=5)


class Migration(migrations.Migration):
    dependencies = [
        ("website", "0242_labs"),
    ]

    operations = [
        migrations.AddField(
            model_name="challenge",
            name="bacon_reward",
            field=models.IntegerField(default=5, help_text="BACON tokens earned for completing the challenge"),
        ),
        migrations.RunPython(
            update_challenge_bacon_rewards,
            reverse_update_challenge_bacon_rewards,
        ),
    ]
